import{u as y,b as M,D as C,i as m,k as B,r as o,o as N,g as T,h as t,w as a,j as U,a as u,y as V}from"./index-1cf03590.js";const j={class:"w-2/5 h-1/2 mx-auto max-sm:w-full max-sm:h-screen max-sm:flex max-sm:items-center"},q={class:"flex items-center"},P={__name:"Login",setup(A){y();const i=M(),l=C(),w=m("axios"),d=m("message"),f=m("dialog"),c=m("loadingBar");let b={account:[{required:!0,message:"请输入账号",trigger:"blur"},{min:3,max:12,message:"账号长度在 3 到 12 个字符之间",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:4,max:18,message:"密码长度在 4 到 18 个字符之间",trigger:"blur"}]};const e=B({account:localStorage.getItem("account")||"",password:localStorage.getItem("password")||"",rememberMe:localStorage.getItem("rememberMe")==1}),h=async()=>{let s=await w.post("/admin/login",{account:e.account,password:e.password});s.data.code==200?(l.id=s.data.data.id,l.account=s.data.data.account,l.token=s.data.data.token,localStorage.setItem("admin_token",l.token),e.rememberMe?(localStorage.setItem("account",e.account),localStorage.setItem("password",e.password),localStorage.setItem("rememberMe",e.rememberMe==!0?1:0)):(localStorage.setItem("account",""),localStorage.setItem("password",""),localStorage.setItem("rememberMe",0)),d.success("登录成功",{duration:600,placement:"bottom-right",showIcon:!0,onAfterLeave:()=>{c.start(),i.push("/dashboard/article"),c.finish()}})):(c.start(),d.error("登录失败",{duration:600}),c.error())},v=()=>{f.create({type:"warning",title:"返回?",negativeText:"取消",positiveText:"确认",onNegativeClick:()=>{},onPositiveClick:()=>{i.push("/")}})};return(s,n)=>{const p=o("n-input"),g=o("n-form-item"),x=o("n-form"),k=o("n-switch"),_=o("n-button"),S=o("n-space"),I=o("n-card");return N(),T("div",j,[t(I,{title:"管理后台登录",class:""},{footer:a(()=>[U("div",q,[t(k,{"rail-style":s.railStyle,value:e.rememberMe,"onUpdate:value":n[2]||(n[2]=r=>e.rememberMe=r)},{checked:a(()=>[u("记住密码")]),unchecked:a(()=>[u("不记住")]),_:1},8,["rail-style","value"]),t(S,null,{default:a(()=>[t(_,{type:"success",class:"ml-12",onClick:h},{default:a(()=>[u("登录")]),_:1}),t(_,{type:"warning",dashed:"",onClick:v},{default:a(()=>[u(" 返回 ")]),_:1})]),_:1})])]),default:a(()=>[t(x,{rules:V(b),model:e},{default:a(()=>[t(g,{path:"account",label:"账号"},{default:a(()=>[t(p,{round:"","show-count":"",autofocus:"",value:e.account,"onUpdate:value":n[0]||(n[0]=r=>e.account=r),placeholder:"请输入账号"},null,8,["value"])]),_:1}),t(g,{path:"password",label:"密码"},{default:a(()=>[t(p,{round:"",type:"password","show-password-on":"click",value:e.password,"onUpdate:value":n[1]||(n[1]=r=>e.password=r),placeholder:"请输入密码"},null,8,["value"])]),_:1})]),_:1},8,["rules","model"])]),_:1})])}}};export{P as default};
