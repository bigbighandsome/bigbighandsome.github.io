import{u as I,b as y,D as C,i as p,k as M,e as L,J as N,r as a,o as U,c as j,w as o,h as t,a as _,y as q}from"./index-da111333.js";const V={__name:"LoginModal",setup(B,{expose:g}){I(),y();const l=C(),f=p("axios"),u=p("message");let w={account:[{required:!0,message:"请输入账号",trigger:"blur"},{min:3,max:12,message:"账号长度在 3 到 12 个字符之间",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:4,max:18,message:"密码长度在 4 到 18 个字符之间",trigger:"blur"}]};const e=M({account:localStorage.getItem("account")||"",password:localStorage.getItem("password")||""}),r=L(!1);N(()=>{});const b=()=>{r.value=!1},v=async()=>{let s=await f.post("/admin/login",{account:e.account,password:e.password});s.data.code==200?(l.id=s.data.data.id,l.account=s.data.data.account,l.token=s.data.data.token,e.rememberMe?(localStorage.setItem("account",e.account),localStorage.setItem("password",e.password),localStorage.setItem("rememberMe",e.rememberMe==!0?1:0)):(localStorage.setItem("account",""),localStorage.setItem("password",""),localStorage.setItem("rememberMe",0)),u.success("登录成功",{duration:600})):u.error(s.data.msg,{duration:600}),r.value=!1};return g({showLoginModal:r}),(s,n)=>{const d=a("n-input"),m=a("n-form-item"),k=a("n-form"),i=a("n-button"),x=a("n-space"),S=a("n-card"),h=a("n-modal");return U(),j(h,{show:r.value,"onUpdate:show":n[2]||(n[2]=c=>r.value=c)},{default:o(()=>[t(S,{title:"管理后台登录",style:{width:"400px"},"transform-origin":"mouse"},{footer:o(()=>[t(x,{justify:"space-between"},{default:o(()=>[t(i,{type:"success",onClick:b},{default:o(()=>[_("取消")]),_:1}),t(i,{type:"success",onClick:v},{default:o(()=>[_("登录")]),_:1})]),_:1})]),default:o(()=>[t(k,{rules:q(w),model:e},{default:o(()=>[t(m,{path:"account",label:"账号"},{default:o(()=>[t(d,{round:"","show-count":"",autofocus:"",value:e.account,"onUpdate:value":n[0]||(n[0]=c=>e.account=c),placeholder:"请输入账号"},null,8,["value"])]),_:1}),t(m,{path:"password",label:"密码"},{default:o(()=>[t(d,{round:"",type:"password","show-password-on":"click",value:e.password,"onUpdate:value":n[1]||(n[1]=c=>e.password=c),placeholder:"请输入密码"},null,8,["value"])]),_:1})]),_:1},8,["rules","model"])]),_:1})]),_:1},8,["show"])}}};export{V as _};
