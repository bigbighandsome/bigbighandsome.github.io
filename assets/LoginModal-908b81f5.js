import{u as S,b as C,D as I,i as p,k as L,e as M,M as N,r as a,o as U,c as j,w as o,h as t,a as _,y as q}from"./index-1cf03590.js";const V={__name:"LoginModal",setup(B,{expose:g}){S(),C();const l=I(),f=p("axios"),u=p("message");let w={account:[{required:!0,message:"请输入账号",trigger:"blur"},{min:3,max:12,message:"账号长度在 3 到 12 个字符之间",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:4,max:18,message:"密码长度在 4 到 18 个字符之间",trigger:"blur"}]};const e=L({account:localStorage.getItem("account")||"",password:localStorage.getItem("password")||""}),r=M(!1);N(()=>{});const v=()=>{r.value=!1},k=async()=>{let s=await f.post("/admin/login",{account:e.account,password:e.password});s.data.code==200?(l.id=s.data.data.id,l.account=s.data.data.account,l.token=s.data.data.token,localStorage.setItem("admin_token",l.token),localStorage.setItem("account",e.account),localStorage.setItem("password",e.password),u.success("登录成功",{duration:600})):u.error(s.data.msg,{duration:600}),r.value=!1};return g({showLoginModal:r}),(s,n)=>{const d=a("n-input"),i=a("n-form-item"),b=a("n-form"),m=a("n-button"),x=a("n-space"),h=a("n-card"),y=a("n-modal");return U(),j(y,{show:r.value,"onUpdate:show":n[2]||(n[2]=c=>r.value=c)},{default:o(()=>[t(h,{title:"管理后台登录",style:{width:"400px"},"transform-origin":"mouse"},{footer:o(()=>[t(x,{justify:"space-between"},{default:o(()=>[t(m,{type:"success",onClick:v},{default:o(()=>[_("取消")]),_:1}),t(m,{type:"success",onClick:k},{default:o(()=>[_("登录")]),_:1})]),_:1})]),default:o(()=>[t(b,{rules:q(w),model:e},{default:o(()=>[t(i,{path:"account",label:"账号"},{default:o(()=>[t(d,{round:"","show-count":"",autofocus:"",value:e.account,"onUpdate:value":n[0]||(n[0]=c=>e.account=c),placeholder:"请输入账号"},null,8,["value"])]),_:1}),t(i,{path:"password",label:"密码"},{default:o(()=>[t(d,{round:"",type:"password","show-password-on":"click",value:e.password,"onUpdate:value":n[1]||(n[1]=c=>e.password=c),placeholder:"请输入密码"},null,8,["value"])]),_:1})]),_:1},8,["rules","model"])]),_:1})]),_:1},8,["show"])}}};export{V as _};
